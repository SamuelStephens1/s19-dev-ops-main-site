---
import { getEntry, render } from 'astro:content';
import BlogPost from '../../layouts/BlogPost.astro';

const slugParam = Astro.params.slug;                 // string | string[]
let id = Array.isArray(slugParam) ? slugParam.join('/') : (slugParam ?? '');

// Normalize: remove .md / .mdx if present
id = id.replace(/\.mdx?$/i, '');

if (!id) throw new Error('Missing blog id');

const entry = await getEntry('blog', id);
if (!entry) throw new Error(`Blog post not found: ${id}`);

const { Content } = await render(entry);
const d = entry.data;
---

<BlogPost
  title={d.title}
  description={d.description}
  pubDate={d.pubDate}
  author={d.author}
  tags={d.tags}
  heroImage={d.heroImage}
>
  <Content />
</BlogPost>
